# Proxifier Toggler 使用指南

## 快速开始

### 安装依赖

```bash
pip install -r requirements.txt
```

## 运行模式

### 🎯 交互模式（推荐新手使用）

**命令**：
```bash
python run.py
```

**说明**：
- 程序启动时会询问你是否需要管理员权限
- 你可以根据需要选择运行模式
- 适合不确定需要哪种模式的用户

**示例输出**：
```
============================================================
Proxifier Toggler - 启动选项
============================================================

请选择运行模式：
  [1] 管理员模式（推荐）- 完整功能，可控制 Proxifier 服务
  [2] 开发模式 - 无需管理员权限，但服务控制功能不可用

请输入选择 [1/2] (默认: 1):
```

---

### 🔧 开发模式（推荐开发调试）

**命令**：
```bash
python run.py --dev
# 或简写
python run.py -d
```

**说明**：
- 跳过管理员权限检查
- 不会弹出 UAC 对话框
- 命令行窗口保持打开，可以看到所有输出
- 显示详细的错误信息和堆栈跟踪

**适用场景**：
- ✅ 开发和调试代码
- ✅ 测试 GUI 界面
- ✅ 查看程序输出日志
- ✅ 快速启动，无需等待 UAC

**限制**：
- ⚠️ 无法启动/停止 Proxifier 服务（需要管理员权限）
- ⚠️ 无法控制系统进程

---

### 🔐 管理员模式（推荐日常使用）

**命令**：
```bash
python run.py --admin
# 或简写
python run.py -a
```

**说明**：
- 自动请求管理员权限
- 会弹出 UAC 对话框（需要点击"是"）
- 程序会以管理员身份重启
- 所有功能完整可用

**适用场景**：
- ✅ 日常使用
- ✅ 需要控制 Proxifier 服务
- ✅ 完整功能测试

**注意事项**：
- ⚠️ 程序重启后，原来的命令行窗口会关闭
- ⚠️ 需要点击 UAC 对话框确认

---

## 查看帮助

查看所有可用的命令行选项：

```bash
python run.py --help
```

输出：
```
usage: run.py [-h] [-d] [-a]

Proxifier Toggler - 系统托盘切换工具

options:
  -h, --help   show this help message and exit
  -d, --dev    开发模式：跳过管理员权限检查
  -a, --admin  管理员模式：直接请求管理员权限
```

---

## 托盘菜单功能

程序启动后会在系统托盘显示图标（任务栏右下角），右键点击可以看到以下菜单：

- **切换 Proxifier**：一键开启/关闭 Proxifier
- **查看状态**：显示当前服务和进程状态
- **设置**：打开配置窗口，修改 Proxifier 路径和服务名称
- **退出**：关闭托盘程序

---

## 常见问题

### Q: 我应该用哪种模式？

**A:** 
- 如果你是**开发者**，正在修改代码 → 使用 `--dev` 模式
- 如果你是**普通用户**，日常使用 → 使用 `--admin` 模式或交互模式选择 [1]
- 如果你**不确定** → 直接运行 `python run.py`，让程序询问你

### Q: 为什么开发模式下无法切换 Proxifier？

**A:** 因为启动/停止 Windows 服务需要管理员权限。开发模式跳过了权限检查，所以无法控制服务。如果需要测试完整功能，请使用管理员模式。

### Q: 如何退出程序？

**A:** 
- 在托盘图标上右键，选择"退出"
- 或者在命令行窗口按 `Ctrl+C`（仅开发模式有效）

### Q: 程序启动后看不到窗口？

**A:** 这是正常的！程序是托盘应用，启动后会在系统托盘运行（任务栏右下角）。请在那里查找图标。

---

## 配置文件

首次运行后，程序会在 `config/` 目录下创建 `config.json` 文件。你可以：

1. **通过 GUI 设置**（推荐）：右键托盘图标 → 设置
2. **手动编辑**：直接修改 `config/config.json` 文件

详细配置说明请参考 [CONFIG.md](CONFIG.md)。
